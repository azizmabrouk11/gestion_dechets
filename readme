# ğŸ—‘ï¸ Waste Management System (Gestion des DÃ©chets)

A comprehensive, enterprise-grade waste management platform for smart cities, built with modern technologies and following clean architecture principles.

## ğŸ¯ Project Overview

This intelligent waste management system provides a complete solution for municipalities to manage waste collection operations, including:
- ğŸ“ **Smart Collection Points** - GPS-tracked pickup locations with real-time container monitoring
- ğŸš› **Fleet Management** - Vehicle tracking, capacity management, and maintenance scheduling
- ğŸ“Š **Admin Dashboard** - Comprehensive analytics and operational control
- ğŸ‘¥ **Citizen Portal** - Community engagement and service information
- ğŸ¤– **AI-Powered Incident Reporting** - Automated email monitoring with duplicate detection
- ğŸ” **Enterprise Security** - OAuth2/OpenID Connect via Keycloak with role-based access control

## ğŸ—ï¸ Architecture

### Tech Stack

**Backend:**
- â˜• **Spring Boot 3.3.0** (Java 17)
- ğŸ—„ï¸ **MongoDB** - NoSQL database for flexible data modeling
- ğŸ”’ **Spring Security + OAuth2** - Resource server with JWT validation
- ğŸ—ºï¸ **MapStruct** - Type-safe bean mapping
- ğŸ“§ **Spring Mail** - Email notification system

**Frontend:**
- ğŸ…°ï¸ **Angular 20** - Modern reactive framework
- ğŸ¨ **Angular Material + Tailwind CSS + DaisyUI** - Beautiful, responsive UI
- ğŸ—ºï¸ **Leaflet** - Interactive maps for collection points
- ğŸ“Š **ApexCharts + Chart.js** - Data visualization
- ğŸ” **Keycloak Angular** - Seamless authentication

**Infrastructure:**
- ğŸ³ **Docker + Docker Compose** - Containerized deployment
- ğŸ”‘ **Keycloak 25.0.5** - Identity and access management
- ğŸ˜ **PostgreSQL 16** - Keycloak database
- ğŸŒ **Nginx** - Reverse proxy for production
- ğŸ¤– **n8n** - Workflow automation

## ğŸ“‹ Prerequisites

Before you begin, ensure you have:
- **Docker Desktop** (v20.10+) - For infrastructure services
- **JDK 17** - For Spring Boot backend development
- **Node.js 20+ & npm** - For Angular frontend development
- **Maven 3.9+** - For backend build (or use included Maven wrapper)
- **Git** - For version control


## ğŸš€ Quick Start Guide

### ğŸ”§ Initial Setup

#### 1. Environment Configuration
Create a `.env` file in the project root (or copy from `.env.example`):

```bash
# Keycloak Configuration
KEYCLOAK_VERSION=25.0.5
KEYCLOAK_ADMIN_USER=admin
KEYCLOAK_ADMIN_PASSWORD=admin
KEYCLOAK_EXTERNAL_FQDN=localhost

# PostgreSQL (Keycloak Database)
KEYCLOAK_DB_NAME=keycloak
KEYCLOAK_DB_USER=keycloak_user
KEYCLOAK_DB_PASSWORD=keycloak_pass

# MongoDB Configuration
MONGO_INITDB_ROOT_USERNAME=root
MONGO_INITDB_ROOT_PASSWORD=admin

# Mongo Express (Web UI)
ME_CONFIG_BASICAUTH_USERNAME=exproot
ME_CONFIG_BASICAUTH_PASSWORD=expadmin

# Application Profile (dev/prod)
PROFILE=dev
```

### ğŸ³ Development Setup (Recommended)

#### Step 1: Start Infrastructure Services
```bash
docker compose up -d mongo mongo-express postgres keycloak
```

**Services starting:**
- MongoDB (port 27017) - Main database
- Mongo Express (port 8089) - Database management UI
- PostgreSQL (port 5433) - Keycloak authentication database
- Keycloak (port 8080) - Identity provider

â±ï¸ **Wait ~30 seconds** for Keycloak to fully initialize and import the realm configuration.

#### Step 2: Configure Frontend Environment
Navigate to frontend and copy the environment example:
```bash
cd frontend
# Copy and configure your environment file
cp src/environments/environment-example.ts src/environments/environment-dev.ts
```

Update `environment-dev.ts` with your local settings (default values usually work):
```typescript
export const environment = {
    production: false,
    API_URL: 'http://localhost:8082/api',
    GRAPHHOPPER_KEY: 'your-graphhopper-api-key',  // For routing features
    KEYCLOAK_URL: 'http://localhost:8080',
    KEYCLOAK_REALM: 'dechetrealm',
    KEYCLOAK_CLIENT_ID: 'dechet-frontend',
};
```

#### Step 3: Run Backend
```bash
cd backend
mvn clean package -DskipTests
mvn spring-boot:run
```
âœ… Backend available at: **http://localhost:8082**

**Or using Maven wrapper (no Maven installation required):**
```bash
# Windows
mvnw.cmd clean package -DskipTests
mvnw.cmd spring-boot:run

# Linux/Mac
./mvnw clean package -DskipTests
./mvnw spring-boot:run
```

#### Step 4: Run Frontend
```bash
cd frontend
npm install --legacy-peer-deps
npm start
```
âœ… Frontend available at: **http://localhost:4200**

### ğŸ“Š Import Test Data (Optional but Recommended)

Load sample data for development and testing:

```powershell
# Navigate to project root directory
cd c:\Users\ADMIN\Desktop\projet-dechet

# Containers
docker cp test-data\containers.json projet-dechet-mongo-1:/tmp/containers.json
docker exec projet-dechet-mongo-1 mongoimport --db dechet_db --collection containers --file /tmp/containers.json --jsonArray --username root --password admin --authenticationDatabase admin

# Pickup Points
docker cp test-data\collectpoints.json projet-dechet-mongo-1:/tmp/collectpoints.json
docker exec projet-dechet-mongo-1 mongoimport --db dechet_db --collection pickuppoints --file /tmp/collectpoints.json --jsonArray --username root --password admin --authenticationDatabase admin

# Vehicles
docker cp test-data\vehicules.json projet-dechet-mongo-1:/tmp/vehicules.json
docker exec projet-dechet-mongo-1 mongoimport --db dechet_db --collection vehicules --file /tmp/vehicules.json --jsonArray --username root --password admin --authenticationDatabase admin

# Incidents
docker cp test-data\incidents.json projet-dechet-mongo-1:/tmp/incidents.json
docker exec projet-dechet-mongo-1 mongoimport --db dechet_db --collection incidents --file /tmp/incidents.json --jsonArray --username root --password admin --authenticationDatabase admin

# Notifications
docker cp test-data\notifications.json projet-dechet-mongo-1:/tmp/notifications.json
docker exec projet-dechet-mongo-1 mongoimport --db dechet_db --collection notifications --file /tmp/notifications.json --jsonArray --username root --password admin --authenticationDatabase admin

# Routes
docker cp test-data\routes.json projet-dechet-mongo-1:/tmp/routes.json
docker exec projet-dechet-mongo-1 mongoimport --db dechet_db --collection routes --file /tmp/routes.json --jsonArray --username root --password admin --authenticationDatabase admin
```

**Note:** MongoDB container name may vary. Check with `docker ps` and adjust if needed.


## ğŸ”— Access URLs & Credentials

### Application URLs

| Service | URL | Description |
|---------|-----|-------------|
| **Frontend Application** | http://localhost:4200 | Main user interface |
| **Backend API** | http://localhost:8082/api | REST API endpoints |
| **Keycloak Admin** | http://localhost:8080 | Identity management |
| **Mongo Express** | http://localhost:8089 | MongoDB web interface |
| **API Documentation** | http://localhost:8082/swagger-ui.html | API docs (if configured) |

### ğŸ‘¤ Default Users

#### Admin Account (Full Access)
- **Username:** `admin`
- **Password:** `nour123`
- **Permissions:** Full system access, user management, analytics

#### Test Citizen/Employee Account
- **Username:** `testuser`
- **Password:** `test123`
- **Permissions:** View collection schedules, report incidents

#### Keycloak Admin Console
- **Username:** `admin`
- **Password:** `admin`
- **Purpose:** Realm and user management

#### Mongo Express
- **Username:** `exproot`
- **Password:** `expadmin`
- **Purpose:** Database inspection and management

## ğŸ“± Features Overview

### ğŸ  Citizen Portal (`/citizen`)
**For residents and employees:**
- ğŸ“ View nearby collection points with interactive maps
- ğŸ“… Check collection schedules and routes
- ğŸ—‘ï¸ Container status and fill levels
- ğŸ“ Report incidents and issues
- ğŸ“š Waste sorting guidelines

### âš™ï¸ Admin Dashboard (`/dashboard`)
**For administrators:**
- ğŸ“Š **Real-time Analytics Dashboard**
  - User statistics (active/inactive)
  - Vehicle fleet status
  - Container monitoring
  - Route efficiency metrics
  
- ğŸ‘¥ **User Management**
  - Role assignment (Admin, Employee, Citizen)
  - Account activation/deactivation
  - Face authentication setup
  
- ğŸš› **Vehicle Fleet Management**
  - Track vehicle status (operational, maintenance)
  - Capacity monitoring
  - Driver assignment
  
- ğŸ—‘ï¸ **Container Management**
  - Real-time fill level monitoring
  - Status tracking (functional, damaged)
  - Type classification (plastic, cardboard, glass, etc.)
  
- ğŸ“ **Pickup Point Management**
  - GPS coordinate mapping
  - Container assignment
  - Location optimization
  
- ğŸ›£ï¸ **Route Planning**
  - Schedule creation
  - Vehicle assignment
  - Pickup point sequencing
  - Time window management

### ğŸ”” Incident Management System
- ğŸ“§ Email-based incident reporting
- ğŸ¤– AI-powered data extraction
- ğŸ” Duplicate detection with similarity matching
- âš¡ Automated notifications to relevant parties
- ğŸ“Š Priority-based incident tracking

## ğŸ”’ Security & Authentication

### OAuth 2.0 / OpenID Connect via Keycloak

**Authentication Flow:**
1. User accesses application
2. Redirected to Keycloak login
3. JWT token issued upon successful authentication
4. Token validated by backend resource server
5. Role-based access control enforced

**User Roles:**
- **ADMIN** - Full system access
- **EMPLOYE** - Employee operations
- **USER** - Citizen portal access

**Security Features:**
- ğŸ” JWT-based stateless authentication
- ğŸ”„ Token refresh mechanism
- ğŸšª Silent SSO check
- ğŸ›¡ï¸ CORS protection
- ğŸ”’ Password policies enforced by Keycloak

## ğŸ“¡ Backend API Endpoints

### Public Endpoints (No Authentication Required)
*Note: Most endpoints require authentication. Public access is limited.*

### Protected Endpoints (Authentication Required)

#### User Management (`/api/public/users`)
- `GET /api/public/users` - List all users
- `GET /api/public/users/{id}` - Get user by ID
- `POST /api/public/users` - Create new user
- `PUT /api/public/users/{id}` - Update user
- `DELETE /api/public/users/{id}` - Delete user

#### Vehicle Management (`/api/public/vehicules`)
- `GET /api/public/vehicules` - List all vehicles
- `GET /api/public/vehicules/{id}` - Get vehicle details
- `POST /api/public/vehicules` - Register new vehicle
- `PUT /api/public/vehicules/{id}` - Update vehicle
- `DELETE /api/public/vehicules/{id}` - Remove vehicle

#### Container Management (`/api/public/containers`)
- `GET /api/public/containers` - List all containers
- `GET /api/public/containers/{id}` - Get container details
- `POST /api/public/containers` - Add new container
- `PUT /api/public/containers/{id}` - Update container
- `DELETE /api/public/containers/{id}` - Remove container

#### Pickup Points (`/api/public/pickuppoints`)
- `GET /api/public/pickuppoints` - List all pickup points
- `GET /api/public/pickuppoints/{id}` - Get point details
- `POST /api/public/pickuppoints` - Create pickup point
- `PUT /api/public/pickuppoints/{id}` - Update pickup point
- `DELETE /api/public/pickuppoints/{id}` - Remove pickup point

#### Route Management (`/api/public/routes`)
- `GET /api/public/routes` - List all routes
- `GET /api/public/routes/{id}` - Get route details
- `POST /api/public/routes` - Create route
- `PUT /api/public/routes/{id}` - Update route
- `DELETE /api/public/routes/{id}` - Delete route

#### Incident Reporting (`/api/public/incidents`)
- `GET /api/public/incidents` - List incidents
- `GET /api/public/incidents/{id}` - Get incident details
- `POST /api/public/incidents` - Report incident
- `PUT /api/public/incidents/{id}` - Update incident
- `DELETE /api/public/incidents/{id}` - Remove incident

#### Notifications (`/api/public/notifications`)
- `GET /api/public/notifications` - List notifications
- `POST /api/public/notifications` - Send notification

#### Admin Operations (`/api/admin`)
- `POST /api/admin/sync` - Sync users with Keycloak

## ğŸ—„ï¸ Database Schema (MongoDB Collections)

### Collections Overview

1. **users** - User accounts and profiles
   - Fields: `id`, `userName`, `email`, `firstName`, `lastName`, `role`, `isActive`, `profileImage`, `faceAuthEnabled`, `driver`, `vehicules[]`
   - Indexes: Unique on `userName` and `email`

2. **vehicules** - Waste collection vehicles
   - Fields: `id`, `matricul`, `type`, `capacity`, `status`, `users[]`
   - Types: TRUCK, COMPACTOR, ELECTRIC, SMALL_VEHICLE

3. **containers** - Waste containers at pickup points
   - Fields: `id`, `type`, `capacity`, `fillLevel`, `containerStatus`, `pickUpPointId`
   - Types: PLASTIC, CARDBOARD, GLASS, ORGANIC, MIXED

4. **pickuppoints** - Collection locations
   - Fields: `id`, `location`, `address`, `latitude`, `longitude`, `containers[]`

5. **routes** - Collection routes and schedules
   - Fields: `id`, `pickUpPoints[]`, `vehicule`, `users[]`, `routeDate`, `startTime`, `endTime`, `status`

6. **incidents** - Reported issues
   - Fields: `id`, `description`, `location`, `priority`, `status`, `reportedBy`, `reportedAt`

7. **notifications** - System notifications
   - Fields: `id`, `userId`, `message`, `type`, `isRead`, `createdAt`


## ğŸ›‘ Stop & Clean Services

### Stop All Services
```bash
docker compose down
```

### Stop and Remove All Data (âš ï¸ WARNING: Deletes all data)
```bash
docker compose down -v
```

### Restart Specific Service
```bash
# Restart Keycloak
docker compose restart keycloak

# Restart MongoDB
docker compose restart mongo

# Restart Backend
docker compose restart backend
```

## ğŸ³ Production Deployment

### Full Stack Docker Deployment

#### 1. Configure Production Environment
Create/update `.env` file for production:

```bash
PROFILE=prod
KEYCLOAK_EXTERNAL_FQDN=your-domain.com
KEYCLOAK_SERVER_URL=https://your-domain.com

# Update MongoDB credentials
MONGO_INITDB_ROOT_USERNAME=secure_username
MONGO_INITDB_ROOT_PASSWORD=secure_password

# Update Keycloak credentials
KEYCLOAK_ADMIN_USER=admin
KEYCLOAK_ADMIN_PASSWORD=secure_password
```

#### 2. Build Docker Images

**Backend:**
```bash
docker build -t your-dockerhub/dechet-backend:latest -f backend/Dockerfile backend
```

**Frontend:**
```bash
docker build \
    --build-arg ENVIRONMENT=production \
    --build-arg API_URL=https://your-domain.com/api \
    --build-arg KEYCLOAK_URL=https://your-domain.com \
    -t your-dockerhub/dechet-frontend:latest \
    -f frontend/Dockerfile \
    frontend
```

#### 3. Push to Registry
```bash
docker push your-dockerhub/dechet-backend:latest
docker push your-dockerhub/dechet-frontend:latest
```

#### 4. Deploy with Docker Compose
```bash
docker compose -f docker-compose.yml up -d
```

### Production Checklist

- [ ] Update all default passwords
- [ ] Configure SSL/TLS certificates (use Let's Encrypt)
- [ ] Set up backup strategy for MongoDB
- [ ] Configure firewall rules
- [ ] Set up monitoring and logging
- [ ] Configure email SMTP credentials
- [ ] Update CORS origins for production domain
- [ ] Review and update Keycloak realm settings
- [ ] Set up automated backups for PostgreSQL (Keycloak)
- [ ] Configure resource limits in docker-compose
- [ ] Set up health checks and alerting


## ğŸ”§ Troubleshooting

### Keycloak Issues

**Problem:** Users cannot log in, Keycloak realm not found
```bash
# Solution: Restart Keycloak and wait for realm import
docker compose restart keycloak
# Wait 30-60 seconds, then check http://localhost:8080
```

**Problem:** Keycloak shows "realm not found"
- Check that the realm configuration file exists: `keycloak/keycloak-import/realm-config-dev.json`
- Verify `PROFILE` environment variable is set correctly in `.env`
- Check Keycloak logs: `docker logs dechet-keycloak`

### Frontend Issues

**Problem:** Build errors or dependency conflicts
```powershell
cd frontend
# Clear cache
Remove-Item -Recurse -Force .angular -ErrorAction SilentlyContinue
Remove-Item -Recurse -Force node_modules -ErrorAction SilentlyContinue
# Reinstall
npm install --legacy-peer-deps
npm start
```

**Problem:** "Cannot connect to backend API"
- Verify backend is running: `curl http://localhost:8082/api`
- Check CORS configuration in `backend/src/main/resources/application-dev.properties`
- Ensure `spring.web.cors.allowed-origins=http://localhost:4200`

### Backend Issues

**Problem:** Backend fails to start - MongoDB connection error
```bash
# Check MongoDB is running
docker ps | grep mongo

# Test MongoDB connection
docker exec -it projet-dechet-mongo-1 mongosh -u root -p admin
```

**Problem:** "Failed to authenticate"
- Verify MongoDB credentials in `.env` and `application-dev.properties`
- Check MongoDB logs: `docker logs projet-dechet-mongo-1`

**Problem:** Port 8082 already in use
```powershell
# Windows: Find process using port
netstat -ano | findstr :8082
# Kill the process (replace PID)
taskkill /PID <process_id> /F

# Or change backend port in application.properties
# server.port=8083
```

### Docker Issues

**Problem:** "Cannot start service: port is already allocated"
```bash
# Check what's using the port
docker ps -a
netstat -ano | findstr :<port_number>

# Stop all containers and retry
docker compose down
docker compose up -d
```

**Problem:** MongoDB container keeps restarting
```bash
# Check logs
docker logs projet-dechet-mongo-1

# Remove volume and recreate
docker compose down -v
docker compose up -d mongo
```

### Database Issues

**Problem:** Test data import fails
```bash
# Verify container name
docker ps --format "{{.Names}}" | grep mongo

# Use correct container name in import commands
docker exec <correct-container-name> mongoimport ...
```

**Problem:** Cannot access Mongo Express
- Verify credentials in `.env` match Mongo Express configuration
- Check if service is running: `docker ps | grep mongo-express`
- Try accessing: http://localhost:8089

### Common Error Messages

| Error | Solution |
|-------|----------|
| `ECONNREFUSED` | Service not started or wrong port |
| `Realm does not exist` | Keycloak not fully initialized, wait and retry |
| `JWT token invalid` | Clear browser cookies/localStorage, login again |
| `Cannot find module` | Run `npm install --legacy-peer-deps` |
| `Port already in use` | Kill process or change port in configuration |
| `Authentication failed` | Check credentials in `.env` and properties files |

## ğŸ¤– Automated Incident Reporting (n8n Workflow)

The system includes an intelligent n8n workflow that automates incident reporting via email.

### Features
- ğŸ“§ **Email Monitoring**: Automatically monitors Gmail for citizen incident reports
- ğŸ¤– **AI-Powered Extraction**: Uses Groq AI to extract structured incident data from emails
- ğŸ” **Duplicate Detection**: Checks MongoDB for similar incidents using AI similarity matching (â‰¥75% threshold)
- ğŸ“¨ **Smart Responses**: 
  - If duplicate detected: Sends automated reply to citizen with existing incident reference
  - If new incident: Notifies admin and creates incident record in database

### Workflow Location
`workflows/incident_report.json`

### Setup Requirements

1. **n8n Instance** - Self-hosted or cloud
2. **Gmail OAuth2 Credentials** - For email monitoring
3. **Groq API Key** - For AI processing (https://groq.com)
4. **MongoDB Connection** - For duplicate detection

### Setup Instructions

1. Import workflow into n8n:
   ```bash
   # In n8n UI: Import workflow from file
   # Select: workflows/incident_report.json
   ```

2. Configure credentials:
   - Gmail OAuth2: Connect your Gmail account
   - Groq API: Add your API key
   - MongoDB: Connection string from `.env`

3. Activate workflow in n8n

### How It Works

```mermaid
graph LR
    A[Gmail Monitor] --> B[Email Received]
    B --> C[Groq AI Extraction]
    C --> D[Parse Incident Data]
    D --> E{Check Duplicates}
    E -->|Duplicate Found| F[Reply to Citizen]
    E -->|New Incident| G[Notify Admin]
    G --> H[Create Incident Record]
```

1. **Email Trigger**: Monitors Gmail inbox every minute
2. **AI Extraction**: Groq AI extracts:
   - Description
   - Location (address/coordinates)
   - Priority (Low/Medium/High/Critical)
3. **Duplicate Check**: Compares with existing incidents using semantic similarity
4. **Conditional Response**:
   - **â‰¥75% similarity**: Automatic reply with confirmation
   - **<75% similarity**: New incident created, admin notified

### Email Format for Citizens

Send emails to configured Gmail address with:
```
Subject: Incident Report - [Brief Description]

Body:
Location: [Street address or coordinates]
Description: [Detailed description of the issue]
Priority: [Low/Medium/High/Critical]
```

### Customization

Edit workflow nodes to:
- Change duplicate similarity threshold
- Modify email templates
- Add additional notification channels
- Integrate with other systems


## ğŸ“¦ Project Structure

```
projet-dechet/
â”œâ”€â”€ backend/                    # Spring Boot Application
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ java/com/nourproject/backend/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ controllers/      # REST API Controllers
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserController.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ VehiculeController.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ContainerController.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PickUpPointController.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RouteController.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IncidentController.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ NotificationController.java
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AdminController.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ entities/         # MongoDB Document Models
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Vehicule.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Container.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PickUpPoint.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Route.java
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Incident.java
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Notification.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ repositories/     # MongoDB Repositories
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ services/         # Business Logic
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ interfaces/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ impl/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dtos/            # Data Transfer Objects
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mappers/         # MapStruct Mappers
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ config/          # Security & Config
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SecurityConfig.java
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ MongoConfig.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ enums/           # Enumerations
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ exceptions/      # Custom Exceptions
â”‚   â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚   â”‚       â”œâ”€â”€ application.properties
â”‚   â”‚   â”‚       â”œâ”€â”€ application-dev.properties
â”‚   â”‚   â”‚       â””â”€â”€ application-prod.properties
â”‚   â”‚   â””â”€â”€ test/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ USER_MANAGEMENT_DOCUMENTATION.md
â”‚
â”œâ”€â”€ frontend/                   # Angular Application
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ admin-layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ map/              # Leaflet map integration
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ profile/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sidebar/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ resources/        # CRUD components
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ home/             # Landing page
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/        # Admin dashboard
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ citizen/          # Citizen portal
â”‚   â”‚   â”‚   â”œâ”€â”€ services/             # HTTP Services
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ vehicule.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ container.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ pickup-point.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ route.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ incident.service.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ notification.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ keycloak/             # Authentication
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ appKeycloakService.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.guard.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ auth.interceptor.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ models/               # TypeScript Models
â”‚   â”‚   â”‚   â””â”€â”€ styles/
â”‚   â”‚   â”œâ”€â”€ environments/
â”‚   â”‚   â”‚   â”œâ”€â”€ environment-dev.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ environment-prod.ts
â”‚   â”‚   â”‚   â””â”€â”€ environment-example.ts
â”‚   â”‚   â””â”€â”€ assets/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ nginx.conf
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ angular.json
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â””â”€â”€ FRONTEND_PAGES_README.md
â”‚
â”œâ”€â”€ keycloak/
â”‚   â””â”€â”€ keycloak-import/
â”‚       â”œâ”€â”€ realm-config-dev.json
â”‚       â””â”€â”€ realm-config-dev example.json
â”‚
â”œâ”€â”€ test-data/                  # Sample Data
â”‚   â”œâ”€â”€ users.json
â”‚   â”œâ”€â”€ vehicules.json
â”‚   â”œâ”€â”€ containers.json
â”‚   â”œâ”€â”€ collectpoints.json
â”‚   â”œâ”€â”€ routes.json
â”‚   â”œâ”€â”€ incidents.json
â”‚   â”œâ”€â”€ notifications.json
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ workflows/                  # n8n Workflows
â”‚   â””â”€â”€ incident_report.json
â”‚
â”œâ”€â”€ devops/                     # Deployment Configurations
â”‚
â”œâ”€â”€ docker-compose.yml          # Docker Services
â”œâ”€â”€ .env                        # Environment Variables
â””â”€â”€ readme                      # This file
```

## ğŸ“š Additional Documentation

- **Backend User Management**: [backend/USER_MANAGEMENT_DOCUMENTATION.md](backend/USER_MANAGEMENT_DOCUMENTATION.md)
- **Frontend Pages Guide**: [frontend/FRONTEND_PAGES_README.md](frontend/FRONTEND_PAGES_README.md)
- **Test Data Import**: [test-data/README.md](test-data/README.md)
- **Angular README**: [frontend/README.md](frontend/README.md)

## ğŸ§ª Testing

### Backend Tests
```bash
cd backend
mvn test
```

### Frontend Tests
```bash
cd frontend
npm test
```

### End-to-End Testing
```bash
cd frontend
npm run e2e
```

## ğŸ”„ Development Workflow

1. **Create Feature Branch**
   ```bash
   git checkout -b feature/your-feature-name
   ```

2. **Make Changes**
   - Backend: Modify Java files in `backend/src/`
   - Frontend: Modify TypeScript/HTML/CSS in `frontend/src/`

3. **Test Locally**
   - Run both backend and frontend
   - Test with sample data
   - Verify authentication flows

4. **Commit Changes**
   ```bash
   git add .
   git commit -m "feat: your feature description"
   ```

5. **Push and Create PR**
   ```bash
   git push origin feature/your-feature-name
   ```

## ğŸŒŸ Key Technologies & Libraries

### Backend Dependencies
- **Spring Boot Starter Data MongoDB** - MongoDB integration
- **Spring Boot Starter Security** - Security framework
- **Spring Boot Starter OAuth2 Resource Server** - JWT validation
- **Keycloak Admin Client 25.0.0** - Keycloak integration
- **MapStruct 1.6.1** - Bean mapping
- **Lombok** - Boilerplate reduction
- **Spring Boot Starter Mail** - Email notifications
- **Spring Boot Starter Validation** - Bean validation

### Frontend Dependencies
- **Angular 20** - Framework
- **Angular Material** - UI components
- **Tailwind CSS** - Utility-first CSS
- **DaisyUI** - Component library
- **Keycloak Angular 20** - Authentication
- **Leaflet** - Interactive maps
- **ApexCharts & Chart.js** - Data visualization
- **ngx-toastr** - Toast notifications
- **Bootstrap 5** - Additional UI components

## ğŸ’¡ Best Practices

### Code Quality
- Follow clean architecture principles
- Use DTOs for API responses
- Implement proper exception handling
- Write meaningful commit messages
- Add comments for complex logic

### Security
- Never commit sensitive data (passwords, API keys)
- Use environment variables for configuration
- Validate all user inputs
- Implement proper CORS policies
- Use HTTPS in production

### Performance
- Implement pagination for large datasets
- Use lazy loading for MongoDB references
- Optimize database queries
- Minify frontend assets for production
- Use CDN for static assets in production

## ğŸš¦ System Requirements

### Minimum Requirements
- **CPU**: 4 cores
- **RAM**: 8 GB
- **Disk**: 20 GB free space
- **OS**: Windows 10/11, macOS 10.15+, Ubuntu 20.04+

### Recommended for Production
- **CPU**: 8 cores
- **RAM**: 16 GB
- **Disk**: 50 GB SSD
- **Network**: Static IP with domain name

## ğŸ“Š Monitoring & Logs

### View Container Logs
```bash
# Backend logs
docker logs -f dechet-backend

# Keycloak logs
docker logs -f dechet-keycloak

# MongoDB logs
docker logs -f projet-dechet-mongo-1

# All services
docker compose logs -f
```

### Application Logs
- **Backend**: Logs to console and file (if configured)
- **Frontend**: Browser console
- **MongoDB**: Docker logs

## ğŸ¤ Contributing

1. Fork the repository
2. Create feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open Pull Request

### Code Style
- **Java**: Follow Google Java Style Guide
- **TypeScript**: Follow Angular Style Guide
- **Naming**: Use descriptive names for variables and functions

## ğŸ“ License

This project is licensed under the MIT License - see the LICENSE file for details.

## ğŸ‘¥ Authors & Contributors

- **Original Author**: Nour Project Team
- **Repository**: https://github.com/azizmabrouk11/gestion_dechets

## ğŸ†˜ Support

For issues and questions:
1. Check this README and additional documentation
2. Search existing GitHub issues
3. Create new issue with detailed description
4. Include error logs and steps to reproduce

## ğŸ”® Future Enhancements

- [ ] Mobile application (React Native/Flutter)
- [ ] Real-time GPS tracking for vehicles
- [ ] IoT sensor integration for container fill levels
- [ ] Advanced analytics and reporting dashboard
- [ ] Multi-language support (i18n)
- [ ] Push notifications
- [ ] Export reports to PDF/Excel
- [ ] Integration with payment systems
- [ ] Citizen mobile app for on-the-go access
- [ ] Machine learning for route optimization
- [ ] Public API with rate limiting

## ğŸ“… Version History

- **v1.0.0** (Current) - Initial release with core features
  - User management with Keycloak
  - Vehicle and container tracking
  - Route planning
  - Incident reporting with AI
  - Admin dashboard and citizen portal

---

**Built with â¤ï¸ for sustainable cities**